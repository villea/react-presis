<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>React.js with ClojureScript</title>
		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="css/reveal.min.css">
		<link rel="stylesheet" href="css/theme/default.css" id="theme">
		<link rel="stylesheet" href="css/solita.css">
		<!-- For syntax highlighting -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- If the query includes 'print-pdf', use the PDF print sheet -->
		<script>
			document.write( '<link rel="stylesheet" href="css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
				<section>
                  <h1> React.js with ClojureScript </h1>
				  <small> Ville Anttonen - Senior Software Designer @ Solita</small>
				</section>
				<!-- Hide for now...
				<section>
					<p>What is Solita?</p>
				  <ul>
					<li>TODO</li>
				  </ul>	
				</section>
				-->
				<section>
                   <p>What is React.js?</p>
                   <ul>
                   	 <li>Javascript library for Web UI</li>
                   	 <li class="fragment">Library instead of full-stack front-end framework like AngularJS</li>
                   	 <li class="fragment">Supreme performance thanks to Virtual DOM</li>
                   	 <li class="fragment">Developed and used by Facebook</li>
                   	 <li class="fragment">Also used many popular sites including Instagram</li>
                   </ul>
				</section>
			
				<section>
					<p> Your beloved "Hello World" with React.js </p>
					<pre>
					<code data-trim>
/** @jsx React.DOM */
var HelloMessage = React.createClass({
  render: function() {
    return <div>Hello {this.props.name}</div>;
  }
});
React.renderComponent(&lt;HelloMessage name="John" /&gt;,
    document.getElementById("container"));  
					</code>
				</pre>
				</section>
				<section>
					<ul>
						<li>React apps are composed with components like.MessageBox,Messages,Message,HelloWorld</li>
						<li class="fragment">With components you can extend standard HTML syntax like directives in AngularJS</li>
						<li class="fragment">Components can be reusable and hold other componenents</li>
						<li class="fragment">Can hold inner state and communicate with other components by callbacks</li>
						<li class="fragment">Can encapsulate third party libraries like jQuery widgets</li>
					</ul>
				</section>
				<section>
					<p>(really) Simple Message app with React</p>
				</section>
				<section>
					<pre>
				   	    <code data-trim>					
var Message = React.createClass({
    render : function(){
        return &lt;p&gt;&lt;b&gt;{this.props.sender}&lt;/b&gt; {this.props.message}&lt;/p&gt;
    }
});

var Messages = React.createClass({
    render : function() {
        return (&lt;ul&gt;
                  {this.props.messages.map(function (msg){
                    return &lt;li&gt;&lt;Message sender={msg.sender} message={msg.message} /&gt;&lt;/li&gt;
                  })}
                &lt;/ul&gt;)
    }
});				
				</code>
				</pre>	
				</section>
				<section>
					<pre>
				   	    <code data-trim>		
var SendMessage = React.createClass({
    getInitialState : function(){
      return { sender : "",
               message : ""}
    },
    render : function(){
        return (
          <form onSubmit={this.handleSubmit}>
            <input type="text" value={this.state.sender} onChange={this.setSender} placeholder="Name" />
            <input type="text" value={this.state.message} onChange={this.setMessage} placeholder="Message" />
            {this.canSend() ? <input type="submit" value="Send"/> : null}
          </form>)
    },
    setSender : function(event){
      this.setState({
        sender : event.target.value
      });
    },
    setMessage : function(event){
     this.setState({
       message : event.target.value
     });
    },
    canSend : function(){
      return this.state.sender.length > 0 && this.state.message.length > 0
    },
    handleSubmit : function(){
        this.props.handler(this.state)
        this.setState({
           sender : "",
           message : ""
        });
        return false
    }
    
});
					</code>
				</pre>
				</section>
				<section>
					<pre>
				   	    <code data-trim>
var MessageApp = React.createClass({
    getInitialState : function(){
       return {messages : this.props.messages}
    },
    render : function(){
        return (
                <div>
                  <SendMessage handler={this.addMessage} />
                  <Messages messages={this.state.messages} />
                </div>
               )
    },
    addMessage : function (msg){
      this.setState({
         messages : this.state.messages.concat([msg])
      });
    }
});

var msgs = [{sender: "Doge", message : "Wow, such example"},
            {sender: "Swag", message : "#Yolo"}]

React.renderComponent(<MessageApp messages={msgs} />, document.body);
				   	    </code>
				   	</pre>	
				</section>
				<section>
					<a href="http://jsfiddle.net/vilan/pBj7m/3/" target="_blank">fiddle</a>
				</section>	
				<section>
					<h2>Enter Clojure(Script)</h2>
				</section>
				<section>
					<p>Why?</p>
					<ul>
						<li class="fragment">Immutable datastructures offers performance optimization</li>
						<li class="fragment">React is "light" library and unopionated</li>
						<li class="fragment">Everybody loves Clojure :) </li>
					</ul>
				</section>
				<section>
					<p>Some trending libraries at the moment</p>
					<ul>
						<li>Om <small><a href="https://github.com/swannodette/om">github.com/swannodette/om</a></small></li>
						<li>Reagent <small><a href="http://holmsand.github.io/reagent">holmsand.github.io/reagent</a></small></li>
						<li>Hoplon <small><a href="http://hoplon.io/">holmsand.github.io/reagent</a></small></li>
					</ul>
				</section>
				<section>
					<p>Using ClojureScript without any libraries</p>
					<pre>
						<code data-trim>
(def comments-data [{:author "Pete Hunt" :text "This is a comment."}
                    {:author "Jordan Walke" :text "This is *another* coment"}])

(def Comment
  (js/React.createClass
   #js {:render (fn []
                  (this-as this
                           (let [comment (.. this -props -comment)]
                             (js/React.DOM.div
                              #js {:className "comment"}
                              (js/React.DOM.h2 nil  (:author comment))
                              (js/React.DOM.span nil (:text comment))))))}))

(def CommentList 
  (js/React.createClass
   #js {:render (fn []
                  (this-as this
                           (js/React.DOM.div
                            #js {:className "commentList"}
                            (into-array
                             (map #(Comment #js {:comment %})
                                  (.. this -props -comments))))))}))

(def CommentBox
  (js/React.createClass
   #js {:render (fn []
                  (this-as this
                           (js/React.DOM.div
                            #js {:className "commentBox"}
                            (js/React.DOM.h1 nil "Comments")
                            (CommentList #js {:comments
                                              (.. this -props -comments)}))))}))

(js/React.renderComponent
 (CommentBox #js {:comments comments-data})
 (.getElementById js/document "content")) 
						</code>
					</pre>
				</section>
				<section>
					<p>..and same with Om - library</p>
					<pre>
						<code data-trim>
(defn comment [{:keys [author text]} c]
  (om/component
   (dom/div #js {:className "comment"}
            (dom/h2 nil author)
            (dom/span nil text))))

(defn comment-list [app]
  (om/component
   (dom/div nil
            (dom/div #js {:className "commentList"}
                     (into-array (map #(om/build comment app
                                                 {:path [%]})
                                      (range (count app))))))))
(defn comment-box [app]
  (om/component
   (dom/div #js {:className "commentBox"}
            (dom/h1 nil "Comment")
            (om/build comment-list app {:path []}))))

(om/root
 comments-data
 comment-box
 (.getElementById js/document "content"))
						</code>
					</pre>
					<small><a href="http://www.lexicallyscoped.com/2013/12/25/slice-of-reactjs-and-cljs.html">Source</a></small>
				</section>	
				
				<section>
					<p>Reagent (ex-Cloact)</p>
					<a href="https://github.com/holmsand/reagent">https://github.com/holmsand/reagent</a>
				</section>
				<section>
					<pre>
					  <code data-trim>
(ns app
  (:require [reagent.core :as reagent :refer [atom]]))

(def messages (atom []))
					  </code>	
				</section>
				<section>
					<pre>
					  <code data-trim>
(defn show-messages []
  (if (> (count @messages) 0)
  [:ul
  (for [msg @messages]
    [:li (str (:sender msg) " : "(:message msg))])]
  [:p "No messages"]))
					  </code>	
				</section>
				<section>
					<pre>
					  <code data-trim>
(defn send-message []
  (let [sender (atom "")
        msg (atom "")]
  (fn []  
  [:div
    [:input {:type "text" 
             :value @sender
             :placeholder "Sender"
             :on-change #(reset! sender (-> % .-target .-value))}] 
    [:input {:type "text" 
             :value @msg
             :placeholder "Message"
             :on-change #(reset! msg (-> % .-target .-value))}]
    (when (and (> (count @sender) 0)
               (> (count @msg) 0))
      [:input {:type "submit" 
               :value "Send"
               :on-click #(do (swap! messages conj {:sender @sender
                                                    :message @msg})
                              (reset! sender "")
                              (reset! msg ""))}])])))
					  </code>		
				</section>
				<section>
					<pre>
					  <code data-trim>
(defn message-app []
  [:div [send-message]
        [show-messages]])

(defn ^:export run []
  (reagent/render-component [message-app]
                            (.-body js/document)))
                      </code>
                    </pre>
                    <small><a href="https://github.com/villea/reagent-example">github.com/villea/reagent-example</a></small>
                </section>		
			<section>
			<p>Hoplon.io</p>		
			<ul>
				<li>"Clojure, everywhere."</li>
				<li class="fragment">Clojure in server.ClojureScript in browser/li>
				<li class="fragment">Built from multiple libraries (Javelin -spreadsheet, Castra RPC,Cljson - client/server communication)</li>
			</ul>
		    </section>
			<section>
			<pre>
			   <code data-trim>	
&lt;script type="text/hoplon"&gt;
  (page "foo/bar.html"
    (:require [my.lib :as lib]))

  (defc clicks 0)
&lt;/script&gt;

&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;Hello World&lt;/title&gt;
    &lt;link rel="stylesheet" href="css/main.css"&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;lib.heading-large&gt;Hello, world!&lt;/lib.heading-large&gt;
    &lt;p&gt;&lt;text&gt;You've clicked ~{clicks} times.&lt;/text&gt;&lt;/p&gt;
    &lt;button on-click="{{ #(swap! clicks inc) }}"&gt;
      Click me!
    &lt;/button&gt;
  &lt;/body&gt;
&lt;/html&gt;		
		   </code>
		</pre>
		</section>
		<section>
			<pre>
			   <code data-trim>	
(page "foo/bar.html"
  (:require [my.lib :as lib]))

(defc clicks 0)

(html
  (head
    (title "Hello World")
    (link :rel "stylesheet" :href "css/main.css"))
  (body
    (lib/heading-large "Hello, world!")
    (p (text "You've clicked ~{clicks} times."))
    (button :on-click #(swap! clicks inc) "Click me!")))	
		   </code>
		</pre>
		</section>	
		<section>
			<h2>Conclusion</h2>
			<ul>
				<li class="fragment">React is nice lightweight library with great performance</li>
				<li class="fragment">React with ClojureScript is great match</li>
				<li class="fragment">ClojureScript+React is quite "bleeding edge" at the moment and libraries around it are very immature</li>
			</ul>
		</section>
		<section>
			<h2>Thank you!</h2>
			<small><a href="https://github.com/solita/">github.com/solita</a></small><br />
			<small><a href="https://github.com/villea">github.com/villea</a></small>
		</section>
			</div>
		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.min.js"></script>

		<script>

			// Full list of confiuration options available here:
			// https://github.com/hakimel/reveal.js#configurationg
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
				transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none

				// Parallax scrolling
				// parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
				// parallaxBackgroundSize: '2100px 900px',

				// Optional libraries used to extend on reveal.js
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
					{ src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
				]
			});

		</script>

	</body>
</html>
